<div class="max-h-screen flex">
    <!-- LEFT SIDEBAR : PAGES -->
    <div class="w-60 border-l bg-gray-50 flex flex-col">
        <div class="px-4 py-3 font-semibold border-b">
            {{ 'main.html-engine.pagesTitle' | translate }}
        </div>

        <div class="p-3 space-y-3 overflow-y-auto bg-white text-sm">
            @for (section of configSections; track section.id) {
                <div
                    class="relative group flex items-center gap-2 py-1.5 px-2 rounded-md cursor-pointer hover:bg-white/60 border border-transparent"
                    [ngClass]="{
                        'bg-white shadow-sm border-default text-primary font-medium':
                            activeSection === section.id,
                    }"
                    (click)="toggleSection(section.id)"
                >
                    <!-- Active left indicator -->
                    @if (activeSection === section.id) {
                        <div class="absolute left-0 top-1 bottom-1 w-1 rounded-r bg-primary"></div>
                    }

                    <!-- Expand Icon -->
                    <span
                        class="flex items-center justify-center w-5 h-5 rounded hover:bg-neutral-subtle transition"
                    >
                        <svg
                            class="w-3.5 h-3.5 transition-transform duration-200 text-neutral-muted"
                            [ngClass]="{
                                'rotate-90 text-primary': activeSection === section.id,
                            }"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="m8.25 4.5 7.5 7.5-7.5 7.5"
                            />
                        </svg>
                    </span>

                    <!-- Folder Icon -->
                    <svg
                        class="w-4.5 h-4.5 text-warning transition-colors duration-150 group-hover:text-primary"
                        fill="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"
                        />
                    </svg>

                    <!-- Folder Name -->
                    <span class="flex-1 truncate text-neutral">
                        {{ section.label }}
                    </span>
                </div>

                <!-- Section content -->
                @if (activeSection === section.id) {
                    <ul class="space-y-1 pl-2">
                        @for (page of section.pages(); track $index) {
                            <li>
                                <button
                                    (click)="loadPage(page.name, section.id)"
                                    class="w-full text-left px-2 py-1.5 rounded text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-colors"
                                >
                                    {{ page.name }}
                                </button>
                            </li>
                        }
                    </ul>
                }
            }
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="flex-1 flex flex-col items-center justify-center overflow-hidden bg-gray-300">
        <iframe
            id="viewer"
            #viewer
            class="border border-gray-500 rounded-md"
            [style.width.px]="activeWindow.width"
            [style.height.px]="activeWindow.height"
            scrolling="no"
        ></iframe>
    </div>

    <!-- RIGHT SIDEBAR : EDITOR -->
    <div class="w-60 border-l bg-gray-50 flex flex-col">
        <div class="px-4 py-3 font-semibold border-b">
            {{ 'main.html-engine.editorTitle' | translate }}
        </div>

        <div class="p-4 space-y-4 overflow-y-auto">
            <!-- size -->
            <div class="grid grid-cols-2 gap-2">
                <div>
                    <label class="block text-sm font-medium">
                        {{ 'main.html-engine.widthLabel' | translate }}
                    </label>
                    (<small class="font-semibold text-[0.7rem]">
                        {{ 'main.html-engine.widthRange' | translate }} </small
                    >)
                    <input
                        type="number"
                        class="w-full px-3 py-2 border rounded"
                        [value]="activeWindow.width"
                        (input)="updateFrameWidth($event)"
                    />
                </div>
                <div>
                    <label class="block text-sm font-medium">
                        {{ 'main.html-engine.heightLabel' | translate }}
                    </label>
                    (<small class="font-semibold text-[0.7rem]">
                        {{ 'main.html-engine.heightRange' | translate }} </small
                    >)
                    <input
                        type="number"
                        class="w-full px-3 py-2 border rounded"
                        [value]="activeWindow.height"
                        (input)="updateFrameHeight($event)"
                    />
                </div>
            </div>

            <!-- window title -->
            <app-text-input
                label="Title"
                [value]="activeWindow.title"
                (input)="updateWindowTitle($event)"
            ></app-text-input>

            <!-- Start page -->
            <app-text-input
                label="Start Page"
                [value]="activeWindow.startPage"
                (input)="updateStartPage($event)"
            ></app-text-input>

            <!-- always on top -->

            <app-check-box
                label="Always On Top"
                [checked]="activeWindow.alwaysOnTop"
                (change)="updateAlwaysOnTop($event)"
            ></app-check-box>

            <!-- actions -->
            <div class="flex gap-2">
                <app-button (buttonClick)="preview()" variant="primary">
                    {{ 'main.html-engine.previewButton' | translate }}
                </app-button>

                <app-button (buttonClick)="reset()" status="warning">
                    {{ 'main.html-engine.resetButton' | translate }}
                </app-button>
            </div>

            <div>
                <app-button class="w-full" (buttonClick)="save()" status="success">
                    {{ 'main.html-engine.saveButton' | translate }}
                </app-button>
            </div>
        </div>
    </div>
</div>
